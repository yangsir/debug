(function(a){a(document).ready(function(){var d=a(".quick_btn"),j=a(".quick_mask"),b=a(".quick_con"),h=function(){d.removeClass("current"),b.removeClass("show").addClass("hide"),j.hide(),d.find("em").show()};d.on("click",function(){var k=a(this);k.hasClass("current")?h():(k.find("em").hide(),k.addClass("current"),b.addClass("show").removeClass("hide"),j.show())}),j.on("click",function(){h()}),a(".quick_list li span").on("click",function(){h();var k=a(this).attr("data-href");if(k.indexOf("javascript:")>=0){a.globalEval(k)}else{var k=k.replace("{uid}",discuz_uid).replace("{fid}",discuz_fid).replace("{tid}",discuz_tid).replace("{pid}",discuz_firstpid);k&&(window.location.href=k)}}),d.on("touchmove",function(k){k.preventDefault()}),b.on("touchmove",function(k){k.preventDefault()}),j.on("touchmove",function(k){k.preventDefault()});a.fn.swiper=function(k){var l=function(ak,ad){function X(){Z=ab.children;af=Z.length;2>Z.length&&(ad.continuous=!1);S.transitions&&(ad.continuous&&3>Z.length)&&(ab.appendChild(Z[0].cloneNode(!0)),ab.appendChild(ab.children[1].cloneNode(!0)),Z=ab.children);V=Array(Z.length);aa=ak.getBoundingClientRect().width||ak.offsetWidth;ab.style.width=Z.length*aa+"px";for(var n=Z.length;n--;){var m=Z[n];m.style.width=aa+"px";m.setAttribute("data-index",n);S.transitions&&(m.style.left=n*-aa+"px",ae(n,aj>n?-aa:aj<n?aa:0,0))}ad.continuous&&S.transitions&&(ae(ag(aj-1),-aa,0),ae(ag(aj+1),aa,0));S.transitions||(ab.style.left=aj*-aa+"px");ak.style.visibility="visible"}function ah(){ad.continuous?ac(aj+1):aj<Z.length-1&&ac(aj+1)}function ag(m){return(Z.length+m%Z.length)%Z.length}function ac(m,q){if(aj!=m){if(S.transitions){var p=Math.abs(aj-m)/(aj-m);if(ad.continuous){var n=p,p=-V[ag(m)]/aa;p!==n&&(m=-p*Z.length+m)}for(n=Math.abs(aj-m)-1;n--;){ae(ag((m>aj?m:aj)-n-1),aa*p,0)}m=ag(m);ae(aj,aa*p,q||ai);ae(m,0,q||ai);ad.continuous&&ae(ag(m-p),-(aa*p),0)}else{m=ag(m),Y(aj*-aa,m*-aa,q||ai)}aj=m;W(ad.callback&&ad.callback(aj,Z[aj]))}}function ae(n,m,p){K(n,m,p);V[n]=m}function K(n,m,p){if(n=(n=Z[n])&&n.style){n.webkitTransitionDuration=n.MozTransitionDuration=n.msTransitionDuration=n.OTransitionDuration=n.transitionDuration=p+"ms",n.webkitTransform="translate("+m+"px,0)translateZ(0)",n.msTransform=n.MozTransform=n.OTransform="translateX("+m+"px)"}}function Y(m,r,q){if(q){var p=+new Date,n=setInterval(function(){var s=+new Date-p;s>q?(ab.style.left=r+"px",M&&o(),ad.transitionEnd&&ad.transitionEnd.call(event,aj,Z[aj]),clearInterval(n)):ab.style.left=(r-m)*(Math.floor(100*(s/q))/100)+m+"px"},4)}else{ab.style.left=r+"px"}}function o(){M=ad.auto||0;O=setTimeout(ah,M)}function C(m){m||(M=0);clearTimeout(O);O=null}var R=function(){},W=function(m){setTimeout(m||R,0)},S={addEventListener:!!window.addEventListener,touch:"ontouchstart" in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(n){var m=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"],p;for(p in m){if(void 0!==n.style[m[p]]){return !0}}return !1}(document.createElement("swipe"))};if(ak){var ab=ak.children[0],Z,V,aa,af;ad=ad||{};var aj=parseInt(ad.startSlide,10)||0,ai=ad.speed||300;ad.continuous=void 0!==ad.continuous?ad.continuous:!0;var M=ad.auto||0,O,J,L,N,U,Q,T,P={handleEvent:function(m){switch(m.type){case"touchstart":this.start(m);break;case"touchmove":this.move(m);break;case"touchend":W(this.end(m));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":W(this.transitionEnd(m));break;case"resize":W(X.call())}ad.stopPropagation&&m.stopPropagation()},start:function(m){m=m.touches[0];J=m.pageX;L=m.pageY;N=+new Date;Q=U=T=void 0;ab.addEventListener("touchmove",this,!1);ab.addEventListener("touchend",this,!1)},move:function(m){if(!(1<m.touches.length||m.scale&&1!==m.scale)){ad.disableScroll&&m.preventDefault();var n=m.touches[0];U=n.pageX-J;Q=n.pageY-L;"undefined"==typeof T&&(T=!!(T||Math.abs(U)<Math.abs(Q)));T||(m.preventDefault(),C(!0),ad.continuous?(K(ag(aj-1),U+V[ag(aj-1)],0),K(aj,U+V[aj],0),K(ag(aj+1),U+V[ag(aj+1)],0)):(U/=!aj&&0<U||aj==Z.length-1&&0>U?Math.abs(U)/aa+1:1,K(aj-1,U+V[aj-1],0),K(aj,U+V[aj],0),K(aj+1,U+V[aj+1],0)))}},end:function(m){m=250>Number(+new Date-N)&&20<Math.abs(U)||Math.abs(U)>aa/2;var p=!aj&&0<U||aj==Z.length-1&&0>U;ad.continuous&&(p=!1);var n=0>U;T||(m&&!p?(n?(ad.continuous?(ae(ag(aj-1),-aa,0),ae(ag(aj+2),aa,0)):ae(aj-1,-aa,0),ae(aj,V[aj]-aa,ai),ae(ag(aj+1),V[ag(aj+1)]-aa,ai),aj=ag(aj+1)):(ad.continuous?(ae(ag(aj+1),aa,0),ae(ag(aj-2),-aa,0)):ae(aj+1,aa,0),ae(aj,V[aj]+aa,ai),ae(ag(aj-1),V[ag(aj-1)]+aa,ai),aj=ag(aj-1)),ad.callback&&ad.callback(aj,Z[aj])):ad.continuous?(ae(ag(aj-1),-aa,ai),ae(aj,0,ai),ae(ag(aj+1),aa,ai)):(ae(aj-1,-aa,ai),ae(aj,0,ai),ae(aj+1,aa,ai)));ab.removeEventListener("touchmove",P,!1);ab.removeEventListener("touchend",P,!1)},transitionEnd:function(m){parseInt(m.target.getAttribute("data-index"),10)==aj&&(M&&o(),ad.transitionEnd&&ad.transitionEnd.call(m,aj,Z[aj]))}};X();M&&o();S.addEventListener?(S.touch&&ab.addEventListener("touchstart",P,!1),S.transitions&&(ab.addEventListener("webkitTransitionEnd",P,!1),ab.addEventListener("msTransitionEnd",P,!1),ab.addEventListener("oTransitionEnd",P,!1),ab.addEventListener("otransitionend",P,!1),ab.addEventListener("transitionend",P,!1)),window.addEventListener("resize",P,!1)):window.onresize=function(){X()};W(ad.oninit&&ad.oninit(aj,Z[aj]));return{setup:function(){X()},stop:C,resume:function(){C();o(!0)},slide:function(n,m){C();ac(n,m)},prev:function(){C();ad.continuous?ac(aj-1):aj&&ac(aj-1)},next:function(){C();ah()},getPos:function(){return aj},getNumSlides:function(){return af},kill:function(){C();ab.style.width="auto";ab.style.left=0;for(var n=Z.length;n--;){var m=Z[n];m.style.width="100%";m.style.left=0;S.transitions&&K(n,0,0)}S.addEventListener?(ab.removeEventListener("touchstart",P,!1),ab.removeEventListener("webkitTransitionEnd",P,!1),ab.removeEventListener("msTransitionEnd",P,!1),ab.removeEventListener("oTransitionEnd",P,!1),ab.removeEventListener("otransitionend",P,!1),ab.removeEventListener("transitionend",P,!1),window.removeEventListener("resize",P,!1)):window.onresize=null}}}};return this.each(function(){var o=a(this),m=o.get(0),n=o.data("delay");return m.swiper=new l(m,a.extend(k||{},{auto:n?n:k.auto}))})};a(".swiper").each(function(){var l=a(this),k=l.children().children("li").length;l.swiper({auto:swdelay,continuous:true,callback:function(m){l.children(".dot-slider").html("<span>"+(m+1)+"</span>/"+k)}});l.children(".dot-slider").html("<span>1</span>/"+k)});if(mobileforumview!=1){a(".sub_forum").css("display","block")}else{a(".sub_forum").css("display","none")}a(".subforumshow").on("click",function(){var l=a(this);var k=a(l.attr("href"));if(k.css("display")=="none"){k.css("display","block");l.find(".arrow").removeClass("no").addClass("yes")}else{k.css("display","none");l.find(".arrow").removeClass("yes").addClass("no")}});a(".favbtn").on("click",function(){var k=a(this);a.ajax({type:"POST",url:k.attr("href")+"&handlekey=favbtn&inajax=1",data:{favoritesubmit:"true",formhash:FORMHASH},dataType:"xml",}).success(function(l){popup.open(l.lastChild.firstChild.nodeValue);evalscript(l.lastChild.firstChild.nodeValue)}).error(function(){window.location.href=k.attr("href");popup.close()});return false});a(".delbtn").on("click",function(){var k=a(this);a.ajax({type:"POST",url:k.attr("href")+"&handlekey=delbtn&inajax=1",data:{favoritesubmit:"true",formhash:"{FORMHASH}"},dataType:"xml",}).success(function(l){popup.open(l.lastChild.firstChild.nodeValue);evalscript(l.lastChild.firstChild.nodeValue)}).error(function(){window.location.href=k.attr("href");popup.close()});return false});a(".typebtn").on("click",function(){if(a(".type_list").hasClass("hide")){a(".type_list").removeClass("hide")}else{a(".type_list").addClass("hide")}});a(".text_ads").each(function(){var n=a(this),m=n.children("li"),l=parseInt(n.data("delay")),k=l?l:addelay;if(m.size()>1){setInterval(function(){var o=m,q=o.index(m.filter(".show")),p=q+1;if(p==o.size()){p=0}o.eq(q).removeClass("show");o.eq(p).addClass("show")},k)}});var f=a(".morelink"),c=function(){a(".video-thumb, .audio-thumb").on("click",function(){var p=a(this),k=a(this).parent(),m=function(r){if(r.find("audio").length){var q=r.find("audio").get(0);if(q.paused||q.ended){a(".audio-thumb").find("audio").each(function(){a(this).get(0).pause()});q.play()}else{q.pause()}a(q).bind({timeupdate:function(){var u=parseInt(q.duration-q.currentTime,10),t=Math.floor(u/60,10),s=u-t*60;r.next(".timeleft").text("-"+t+":"+(s<10?"0"+s:s))},play:function(){r.removeClass("pause").addClass("playing")},"pause ended":function(){r.removeClass("playing").addClass("pause")}})}};if(!p.find("video, audio, iframe").length){if(k.data("type")=="video"){if(k.data("form")=="youku"&&typeof(k.data("item"))!="undefined"){var l=k.data("item").split("-");a.getJSON(SITEURL+"plugin.php?id=lyrs_mobile:proxy&type=youku&vid="+l[0]+"&key="+l[1]+"&callback=?",function(q){if(q.src){k.html('<video src="'+q.src+'" controls="controls"></video>');k.find("video").get(0).play()}else{k.html('<iframe src="'+k.data("media")+'" frameborder=0 allowfullscreen></iframe>')}})}else{k.html('<video src="'+k.data("media")+'" controls="controls"></video>');k.find("video").get(0).play()}}else{if(k.data("type")=="audio"){if(k.data("form")=="xiami"&&typeof(k.data("item"))!="undefined"){var o=k.data("item").split("-");a.getJSON(SITEURL+"plugin.php?id=lyrs_mobile:proxy&type=xiami&aid="+o[0]+"&key="+o[1]+"&callback=?",function(q){if(q.src){p.find("em").html('<audio src="'+q.src+'" controls="controls"></audio>');p.after('<span class="timeleft"></span>');m(p)}})}else{if(k.data("form")=="vdisk"&&typeof(k.data("item"))!="undefined"){var n=k.data("item").split("-");a.getJSON(SITEURL+"plugin.php?id=lyrs_mobile:proxy&type=vdisk&aid="+n[0]+"&key="+n[1]+"&callback=?",function(q){if(q.src){p.find("em").html('<audio src="'+q.src+'" controls="controls"></audio>');p.after('<span class="timeleft"></span>');m(p)}})}else{p.find("em").html('<audio src="'+k.data("media")+'" controls="controls"></audio>');p.after('<span class="timeleft"></span>')}}}else{if(k.data("type")=="iframe"){k.html('<iframe src="'+k.data("media")+'" frameborder=0 allowfullscreen></iframe>')}}}}m(p)})};c();if(f.data("num")){var e=f.data("num").split("-"),i=parseInt(e[0])+1,g=parseInt(e[1])+1;f.on("click",function(k){k.preventDefault();a.ajax({url:a(this).attr("href"),data:{page:g},beforeSend:function(){f.text(language.loading)},success:function(l){if(l){if(f.data("order")){g--}else{g++}a(".pagelist").append(l.substring(l.indexOf("<!-- more pagelist start -->"),l.indexOf("<!-- more pagelist end -->")));popup.init();c()}if(g==i||(f.data("order")&&g==0)){f.remove()}else{f.text(language.view_more)}}});return false})}})})(jQuery);